bluemix-php-frameworks
======================

#### Provides guidance for using Drupal within the BlueMix environment [Steps verified with Drupal 7.31]

<h5>Drupal is a free and open-source content management framework written in PHP. It is used as a back-end framework for at least 2.1% of all websites worldwide ranging from personal blogs to corporate, political, and government sites including whitehouse.gov and data.gov.uk. It is also used for knowledge management and business collaboration</h5><p>In order to have Drupal work on the IBM BlueMix Platform, do the following:</p><ol><ol><ol><li>Download a current stable version of Drupal from <a href="https://drupal.org/project/drupal" title="Drupal Project Page">https://drupal.org/project/drupal</a>.</li><li>Untar or unzip the download (e.g. tar -xzf drupal-7.26.tar.gz) and change to the base directory (e.g. drupal-7.26).</li><li>One of the most important files on a Drupal site is the settings.php file.  This file is located in the <strong>default</strong> subfolder of the <strong>sites</strong> root directory within a Drupal installation and contains the Drupal website's base configuration details, such as database connection information, multisite options and login details.  For the BlueMix platform, database connection information is dynamically generated during service instantiation and shared within environment variables.  Therefore, a config file structured to read the MySQL environment variable details is necessary. Insert or replace the <b><i>settings.php</i></b> within the Drupal */sites/default directory with the one in <a href="https://github.com/ibmjstart/bluemix-php-frameworks/tree/master/drupal">this repository</a>.</li><li>Copy this file into the folder &lt;base_directory&gt;<span style="font-size: 22px; color: red;">/sites/default<br /></span><pre>bash-3.2$ <span style="color: #ffffff;">cp settings.php drupal-7.26/sites/default<br /></span></pre></li>
<li>Copy the <b>.bp-config</b> folder with its included options.json file into the root of your drupal directory.  It is extremely important to verify that your options.json includes the pdo_mysql extension.</li> 
<li>Using the <a href="https://github.com/cloudfoundry/cli/releases/tag/v6.0.0" title="Link to the Cloud Foundry v6 cli github repository binaries">cloud foundry v6 cli</a>, login to BlueMix and install Drupal with a PHP buildpack.<br />&lt;&lt;random number&gt;&gt; is user provided input.<br /><pre># Step 0: cf login -a &lt;api target url&gt; <br />$ <span style="color: white;">cf login -a https://api.ng.bluemix.net</span> <br /><br /># Step 1: cf create-service &lt;service name&gt; &lt;service plan type&gt; &lt;unique service instance name&gt;<br />$ <span style="color: #ffffff;">cf create-service mysql 100 mysql-drupal-service</span><br /><br /><span style="font-size: 12px;"># Step 2: cf push &lt;unique application name&gt; -b &lt;url to php buildpack&gt; --no-manifest (No manifest.yml present) --no-start (Don't start application after push)<br /></span><span style="font-size: 12px;"># Buildpack choices:  <br /></span><span style="font-size: 12px;">#  Basic - https://github.com/heroku/heroku-buildpack-php.git<br /></span><span style="font-size: 12px;">#  ZLib Support (Gzip compression)- https://github.com/cyberdelia/heroku-buildpack-php.git<br /></span><span style="font-size: 12px;">$ <span style="color: #ffffff;">cf push mysql-drupal-&lt;&lt;random number&gt;&gt; -b https://github.com/dmikusa-pivotal/cf-php-build-pack --no-manifest --no-start</span><br /><br /></span><span style="font-size: 12px;"># Step 3: cf bind-service &lt;unique application name used in Step 2&gt; &lt;service instance name used in Step 1&gt;<br /></span><span style="font-size: 12px;">$ <span style="color: #ffffff;">cf bind-service mysql-drupal-&lt;&lt;random number&gt;&gt; mysql-drupal-service</span><br /><br /></span><span style="font-size: 12px;"># Step 4: cf start &lt;unique application name used in Step 2&gt; (Start application)<br /></span><span style="font-size: 12px;">$ <span style="color: #ffffff;">cf start mysql-drupal-&lt;&lt;random number&gt;&gt;</span><br /></span></pre></li><li>After the application is running on BlueMix, browse to http://&lt;your_app_name&gt;.ng.bluemix.net<span style="font-size: 22px; color: red;">/install.php</span> and complete the installation steps<br /><br /></li><li>That's it!.</li></ol></ol></ol><p><span style="text-decoration: underline;">FAQ<br /><br /></span>Q:  I'm encountering a PDOException: SQLSTATE[]: Base table or view not found error similar to below.  What's going on here?</p><p><a href="https://www.ibmdw.net/bluemix/wp-content/uploads/sites/20/2014/02/IncompleteInstall.png"></a><a href="https://www.ibmdw.net/bluemix/wp-content/uploads/sites/20/2014/02/IncompleteInstall.png"><img src="https://www.ibmdw.net/bluemix/wp-content/uploads/sites/20/2014/02/IncompleteInstall.png" alt="IncompleteInstall" width="830" height="409" class="aligncenter size-full wp-image-955" /></a><br />A:  The drupal installation is incomplete.  Please complete all installation steps by browsing to http://&lt;your_app_name&gt;.ng.bluemix.net<span style="font-size: 22px; color: red;">/install.php</span><br /><br /><a href="https://www.ibmdw.net/bluemix/wp-content/uploads/sites/20/2014/02/SetupStartPage.png"><img src="https://www.ibmdw.net/bluemix/wp-content/uploads/sites/20/2014/02/SetupStartPage.png" alt="SetupStartPage" width="563" height="427" class="aligncenter size-full wp-image-956" /></a></p>
